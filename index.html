<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pancracio World</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; }
        body { margin: 0; overflow: hidden; font-family: 'Press Start 2P', cursive; background: #5c94fc; width: 100vw; height: 100vh; }
        
        /* PANTALLA INICIAL */
        #inicio {
            position: fixed; inset: 0; background: #000;
            display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 1000;
        }
        #inicio h1 { color: #fff; font-size: 18px; text-align: center; margin-bottom: 40px; line-height: 2; }
        #btn-play { background: #e7691d; color: #fff; border: 4px solid #fff; padding: 20px 40px; font-family: 'Press Start 2P'; font-size: 15px; border-radius: 10px; }

        /* ESCENARIO */
        #mundo { display: none; width: 100%; height: 100%; position: relative; overflow: hidden; }
        .pasto { position: absolute; bottom: 0; width: 100%; height: 100px; background: #71aa34; border-top: 6px solid #3e611d; z-index: 10; }
        .rio { position: absolute; bottom: 0; left: 40%; width: 80px; height: 70px; background: #4d92d4; z-index: 11; border-top: 4px solid #fff; }
        
        /* DECORACI√ìN */
        .nube { position: absolute; background: #fff; width: 60px; height: 25px; border-radius: 20px; top: 50px; opacity: 0.8; }
        .arbol { position: absolute; bottom: 100px; width: 40px; height: 60px; background: #2d4d1a; border-radius: 20px 20px 0 0; }

        /* PERSONAJE */
        #pancracio { 
            position: absolute; bottom: 100px; left: 30px; width: 40px; height: 40px; 
            background: #ff4500; border: 3px solid #000; z-index: 100;
            transition: bottom 0.25s cubic-bezier(0.17, 0.67, 0.83, 0.67);
        }

        /* OBJETOS */
        .star { 
            position: absolute; width: 30px; height: 30px; background: #ffff00; 
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
            box-shadow: 0 0 15px gold; z-index: 50;
        }
        #llave-caja { 
            position: absolute; right: 30px; bottom: 100px; width: 60px; height: 60px; 
            background: #8b4513; border: 4px solid #5d2e0d; display: none;
            justify-content: center; align-items: center; font-size: 30px; z-index: 90;
        }

        /* CONTROLES */
        #ui-controles {
            position: absolute; bottom: 20px; width: 100%;
            display: flex; justify-content: space-evenly; z-index: 500;
        }
        .btn-game {
            background: rgba(0,0,0,0.8); color: #fff; border: 3px solid #fff;
            width: 80px; height: 60px; display: flex; justify-content: center; align-items: center;
            border-radius: 15px; font-family: 'Press Start 2P'; font-size: 10px;
        }

        #puntos { position: absolute; top: 20px; left: 20px; color: #fff; font-size: 12px; z-index: 600; background: rgba(0,0,0,0.4); padding: 10px; border-radius: 5px; }
        
        /* MENSAJE FINAL */
        #final {
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9);
            flex-direction: column; justify-content: center; align-items: center;
            color: #ffff00; text-align: center; z-index: 2000; padding: 20px;
        }
        #final h2 { text-shadow: 4px 4px #ff0000; font-size: 20px; line-height: 1.6; }
    </style>
</head>
<body>

    <div id="inicio">
        <h1>¬øQUI√âN<br>ERES?</h1>
        <button id="btn-play" onclick="empezar()">JUGAR</button>
    </div>

    <div id="mundo">
        <div id="puntos">STARS: <span id="val">0</span>/5</div>
        
        <div class="nube" style="left: 10%;"></div>
        <div class="nube" style="left: 60%; top: 100px;"></div>
        <div class="arbol" style="left: 20%;"></div>
        <div class="arbol" style="left: 80%;"></div>
        
        <div class="rio"></div>
        <div class="pasto"></div>
        
        <div id="pancracio"></div>
        <div id="llave-caja">üéÅ</div>

        <div id="ui-controles">
            <button class="btn-game" ontouchstart="mover(-1)" ontouchend="parar()">IZQ</button>
            <button class="btn-game" ontouchstart="saltar()">SALTAR</button>
            <button class="btn-game" ontouchstart="mover(1)" ontouchend="parar()">DER</button>
        </div>
    </div>

    <div id="final">
        <h2>¬°ERES UN PANCRACIO, PANCRACIO! üòÇ</h2>
        <button onclick="location.reload()" style="margin-top:40px; padding:10px; font-family:'Press Start 2P';">REINTENTAR</button>
    </div>

    <script>
        let starsFound = 0;
        let x = 30;
        let y = 100;
        let isJumping = false;
        let timer;
        const player = document.getElementById('pancracio');
        const box = document.getElementById('llave-caja');

        function empezar() {
            document.getElementById('inicio').style.display = 'none';
            document.getElementById('mundo').style.display = 'block';
            spawnStars();
            // Loop de colisiones
            setInterval(check, 10);
        }

        function spawnStars() {
            for(let i=0; i<5; i++) {
                let s = document.createElement('div');
                s.className = 'star';
                s.style.left = (80 + (i * (window.innerWidth / 6))) + 'px';
                s.style.bottom = (180 + Math.random() * 40) + 'px'; 
                document.getElementById('mundo').appendChild(s);
            }
        }

        function mover(dir) {
            if(timer) clearInterval(timer);
            timer = setInterval(() => {
                x += dir * 7;
                if(x < 0) x = 0;
                if(x > window.innerWidth - 40) x = window.innerWidth - 40;
                player.style.left = x + 'px';
            }, 20);
        }

        function parar() { clearInterval(timer); }

        function saltar() {
            if(!isJumping) {
                isJumping = true;
                y = 220; // Altura del salto
                player.style.bottom = y + 'px';
                setTimeout(() => {
                    y = 100; // Vuelve al suelo
                    player.style.bottom = y + 'px';
                    setTimeout(() => { isJumping = false; }, 200);
                }, 300);
            }
        }

        function check() {
            const pRect = player.getBoundingClientRect();
            
            // Estrellas
            document.querySelectorAll('.star').forEach(s => {
                const sRect = s.getBoundingClientRect();
                if (!(pRect.right < sRect.left || pRect.left > sRect.right || pRect.bottom < sRect.top || pRect.top > sRect.bottom)) {
                    s.remove();
                    starsFound++;
                    document.getElementById('val').innerText = starsFound;
                    if(starsFound === 5) box.style.display = 'flex';
                }
            });

            // Caja Final
            if(starsFound === 5) {
                const bRect = box.getBoundingClientRect();
                if (!(pRect.right < bRect.left || pRect.left > bRect.right || pRect.bottom < bRect.top || pRect.top > bRect.bottom)) {
                    document.getElementById('final').style.display = 'flex';
                }
            }
        }
    </script>
</body>
</html>
