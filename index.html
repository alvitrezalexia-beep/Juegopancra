<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pancracio Game</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; }
        body { margin: 0; overflow: hidden; font-family: 'Press Start 2P', cursive; background: #5c94fc; width: 100vw; height: 100vh; }
        
        /* Pantalla de Inicio */
        #pantalla-inicio {
            position: fixed; inset: 0; background: #000;
            display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 100;
        }
        h1 { color: #fff; font-size: 14px; text-align: center; margin-bottom: 30px; }

        /* Contenedor del Juego */
        #juego { display: none; width: 100%; height: 100%; position: relative; }
        .pasto { position: absolute; bottom: 0; width: 100%; height: 80px; background: #71aa34; border-top: 4px solid #3e611d; }
        .rio { position: absolute; bottom: 0; left: 30%; width: 60px; height: 60px; background: #4d92d4; }

        /* Personaje */
        #player { 
            position: absolute; bottom: 80px; left: 20px; width: 30px; height: 30px; 
            background: #ff4500; border: 2px solid #000; z-index: 10; transition: transform 0.1s ease-out;
        }

        /* Estrellas bajitas */
        .estrella { 
            position: absolute; width: 20px; height: 20px; background: gold; 
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
            z-index: 5;
        }

        /* Caja y Llave */
        .caja { 
            position: absolute; right: 15px; bottom: 80px; width: 45px; height: 45px; 
            background: #8b4513; border: 3px solid #5d2e0d; display: none;
            justify-content: center; align-items: center; font-size: 18px;
        }

        /* Controles ajustados */
        #controles {
            position: absolute; bottom: 10px; width: 100%;
            display: flex; justify-content: space-evenly; z-index: 50;
        }
        .btn {
            background: rgba(0,0,0,0.7); color: white; border: 2px solid #fff;
            padding: 15px; font-family: 'Press Start 2P'; font-size: 9px; border-radius: 8px;
        }

        #marcador { position: absolute; top: 10px; left: 10px; color: white; font-size: 10px; z-index: 60; }
        #mensaje-final {
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9);
            flex-direction: column; justify-content: center; align-items: center;
            color: yellow; text-align: center; z-index: 200; font-size: 14px; padding: 20px;
        }
    </style>
</head>
<body>

    <div id="pantalla-inicio">
        <h1>Â¿QUIÃ‰N ERES?</h1>
        <button onclick="iniciar()" style="padding:10px; font-family:'Press Start 2P';">JUGAR</button>
    </div>

    <div id="juego">
        <div id="marcador">ESTRELLAS: <span id="p">0</span>/5</div>
        <div class="rio"></div>
        <div class="pasto"></div>
        <div id="player"></div>
        <div id="caja" class="caja">ðŸ”‘</div>

        <div id="controles">
            <button class="btn" ontouchstart="mv(-1)" ontouchend="st()">IZQ</button>
            <button class="btn" ontouchstart="jp()">SALTAR</button>
            <button class="btn" ontouchstart="mv(1)" ontouchend="st()">DER</button>
        </div>
    </div>

    <div id="mensaje-final">
        <p>Â¡ERES UN PANCRACIO, PANCRACIO! ðŸ˜‚</p>
        <button onclick="location.reload()" style="margin-top:20px; font-family:'Press Start 2P';">VOLVER</button>
    </div>

    <script>
        let s = 0, px = 20, py = 0, jm = false, mt;
        const pl = document.getElementById('player');

        function iniciar() {
            document.getElementById('pantalla-inicio').style.display = 'none';
            document.getElementById('juego').style.display = 'block';
            for(let i=0; i<5; i++) {
                let st = document.createElement('div');
                st.className = 'estrella';
                // PosiciÃ³n horizontal repartida y altura baja (entre 120px y 180px del suelo)
                st.style.left = (60 + (i * (window.innerWidth/6))) + 'px';
                st.style.bottom = (130 + (Math.random() * 40)) + 'px'; 
                document.getElementById('juego').appendChild(st);
            }
        }

        function mv(d) {
            mt = setInterval(() => {
                px += d * 6;
                if(px < 0) px = 0;
                if(px > window.innerWidth - 30) px = window.innerWidth - 30;
                pl.style.left = px + 'px';
                ck();
            }, 20);
        }
        function st() { clearInterval(mt); }
        function jp() {
            if(!jm) {
                jm = true;
                pl.style.transform = "translateY(-90px)"; // Altura de salto ajustada
                setTimeout(() => {
                    pl.style.transform = "translateY(0)";
                    setTimeout(() => { jm = false; }, 200);
                }, 300);
            }
        }

        function ck() {
            const pr = pl.getBoundingClientRect();
            document.querySelectorAll('.estrella').forEach(e => {
                const er = e.getBoundingClientRect();
                if(!(pr.right<er.left || pr.left>er.right || pr.bottom<er.top || pr.top>er.bottom)) {
                    e.remove(); s++; document.getElementById('p').innerText = s;
                    if(s === 5) document.getElementById('caja').style.display = 'flex';
                }
            });
            const cj = document.getElementById('caja');
            const cr = cj.getBoundingClientRect();
            if(s === 5 && !(pr.right<cr.left || pr.left>cr.right || pr.bottom<cr.top || pr.top>cr.bottom)) {
                document.getElementById('mensaje-final').style.display = 'flex';
            }
        }
    </script>
</body>
</html>
